import numpy as np
import h5py
import os
import requests
import tempfile
import time
import scann

file = "/arc-share/MICRO21_ANNA/GLOVE/glove-100-angular.hdf5"
glove = h5py.File(file, "r")
dataset = glove['train']
queries = glove['test']
normalized_dataset = dataset / np.linalg.norm(dataset, axis=1)[:, np.newaxis]
vector1 = normalized_dataset[624158]
vector2 = normalized_dataset[908319]
#print(vector1[0], vector1[1])
#print(vector2[0], vector2[1])

c_center = np.array([-0.0404346,  -0.0693853,-0.0458093,  -0.0637792,-0.0309558,  -0.0516427,0.0718772,  -0.0884135,0.0213391,  -0.00364265,-0.0452618,  -0.0130821, 0.118707,  0.0182047, -0.0532199,  -0.0250593, -0.0544316,  -0.00470514, 0.072439,  0.0763962, 0.0475745,  0.0550659, 0.0458984,  -0.0424401, -0.00605455,  0.168757,0.085454,  0.0861132,-0.0603476,  -0.0148479, 0.0634478,  0.0347207, 0.145257,  -0.134091,-0.21494, 0.0145528,-0.0109735,  0.0102127,-0.0392798,  -0.0569372,0.113746,  0.0656886,0.0842909,  -0.0273673,-0.224266,  0.0981552,-0.0599357,  -0.044377,-0.0295053,  0.0506176,0.121966,  -0.0132307,0.00431723,  -0.0277751,-0.0912924,  -0.0305258,0.0656234,  0.107634,0.0175794,  0.00486948,-0.0386377,  0.0151747, 0.0139722,  -0.00424933, -0.0397722  ,0.0481185, 0.0284152,  0.0143047, -0.0046606,  -0.101583, -0.0112927,  -0.0759872, -0.00642442,  0.0314794, -0.0916162,  0.0249062, 0.149825,  0.0126012,-0.0257616,  0.0954824,-0.146622,  0.000885661, -0.0553071,  0.00741968,-0.0823656,  0.00942343, 0.0427149,  -0.153871, 0.0739136,  -0.0598786, 0.00830218,  -0.0234816, 0.0188976,  0.0361484, -0.0606736,  0.0178299, 0.00304676,  0.0822414, -0.0905958,  0.0794369])
print("c_center shape:", c_center.shape)

p_center = np.array([[-0.00315878, 0.0127081, 0.0578744, -0.0154778, -0.0686726, -0.0100868, -0.0388573, -0.0704771, 0.0277206, -0.075228, 0.0606602, 0.0538177, -0.0553738, 0.0606409, 0.00647553, 0.0996667, 0.11938, -0.0848538, 0.148096, 0.0225966, -0.150415, -0.0149656, -0.109535, -0.117922, 0.0145106, -0.163194, -0.129656, 0.0882118, 0.100101, 0.133672, -0.0405285, 0.169766], [-0.00315878, 0.0127081, 0.0578744, -0.0154778, -0.0686726, -0.0100868, -0.0388573, -0.0704771, 0.0277206, -0.075228, 0.0606602, 0.0538177, -0.0553738, 0.0606409, 0.00647553, 0.0996667, 0.11938, -0.0848538, 0.148096, 0.0225966, -0.150415, -0.0149656, -0.109535, -0.117922, 0.0145106, -0.163194, -0.129656, 0.0882118, 0.100101, 0.133672, -0.0405285, 0.169766], [-0.0310145, -0.0303094, -0.049679, 0.0337311, 0.0305332, 0.0144934, 0.065717, -0.0302578, 0.0110576, -0.0826547, 0.0215232, 0.0725063, 0.110509, 0.0629121, -0.125187, -0.0399135, -0.0754766, -0.115266, -0.030712, 0.117607, -0.13162, 0.0486646, 0.104649, -0.103672, 0.158833, -0.0141124, 0.0644738, 0.153666, 0.0185783, -0.167211, -0.105343, 0.146244], [0.023943, -0.18481, -0.122412, 0.108687, -0.0209989, 0.167166, 0.103968, 0.123027, 0.125052, -0.0947892, -0.151852, -0.0042699, 0.145299, 0.0138577, -0.0939188, -0.114645, 0.0231437, -0.107432, 0.0130044, 0.0887129, 0.0626392, 0.0372985, -0.0732329, -0.0189776, -0.0196239, -0.0592923, -0.0573059, 0.0569135, 0.0589233, -0.0365692, -0.00143858, 0.00878161], [0.0105467, 0.00584682, -0.00789612, 0.0676879, -0.0684253, 0.0267637, 0.0474618, -0.0613127, -0.0252308, -0.0408314, 0.074398, 0.0154676, -0.0879574, -0.0503173, 0.0655583, 0.10593, -0.0189973, -0.120804, 0.139604, -0.0510179, -0.107872, 0.106293, -0.0139328, 0.156811, -0.161049, 0.00386986, 0.0733212, -0.148994, 0.1491, 0.0635619, -0.115416, -0.132916], [0.0719461, -0.165335, 0.173254, -0.00893221, 0.0648045, 0.153205, -0.0591378, -0.157974, 0.119973, -0.0842758, 0.126092, 0.0709818, -0.0657115, 0.134075, -0.130289, 0.0522191, -0.123516, -0.0450601, 0.0305942, -0.0881899, 0.00814114, 0.088962, 0.0804991, -0.0185447, -0.0464177, -0.0692818, 0.0471799, 0.0371838, 0.00428022, -0.020828, -0.0424103, 0.0268801], [0.0254042, 0.054691, -0.0387149, 0.0450895, 0.0238844, -0.0213508, -0.0309622, -0.0248554, 0.00835647, -0.0842583, 0.0721285, -0.00359522, -0.0940365, -0.00814998, -0.0784169, -0.0965898, -0.0365552, 0.131111, 0.112079, 0.0661787, 0.0765264, -0.114143, 0.0509624, 0.140787, -0.12623, 0.0807711, 0.135962, -0.0428291, -0.0153034, -0.170648, -0.187852, -0.0335703], [0.174461, 0.050163, -0.13092, 0.113715, 0.0690055, -0.138407, 0.0786652, 0.135895, -0.107912, -0.103114, -0.147688, -0.012532, -0.0278987, -0.142841, 0.126492, -0.0629461, -0.0243858, 0.129905, 0.0990811, 0.0276187, -0.0781039, 0.0456038, 0.0349277, 0.0624249, 0.013242, -0.0659819, 0.0467376, -0.015661, -0.0524206, -0.0364216, -0.0151625, 0.0249376], [0.0266493, -0.0414345, -0.0387664, 0.00287163, 0.0256021, 0.0202018, -0.0267466, 0.0759702, -0.0592606, -0.0585162, 0.104083, -0.00200574, 0.0574376, 0.0801524, 0.0167338, -0.10346, -0.104548, 0.0309187, 0.118504, -0.0910568, -0.103853, 0.125343, 0.0204089, 0.162195, -0.101814, -0.12463, -0.163267, -0.0282592, 0.14989, 0.0815737, 0.00296657, -0.179787], [0.140397, 0.0884661, -0.139862, 0.0887004, 0.0353053, -0.162858, 0.131469, -0.0865224, 0.0448159, 0.151185, -0.0922417, -0.130547, -0.148948, -0.0257016, -0.0484709, 0.132505, 0.108972, 0.00733063, -0.00103455, -0.0869551, -0.0730564, 0.0291735, -0.0615343, -0.0445341, 0.0494739, 0.0592853, -0.0145715, 0.0588404, 0.0560366, -0.0435871, 0.00307793, -0.00569851], [-0.0192766, -0.00922093, 0.0529294, -0.0210847, 0.0134991, 0.04116, -0.0637201, 0.0560449, 0.0147201, -0.0734031, -0.0800345, -0.0231481, 0.085942, 0.0410327, 0.0161026, 0.104016, -0.0577764, -0.0900916, 0.133068, -0.0540865, -0.160346, -0.0102857, 0.0587648, -0.142828, -0.105057, 0.124633, 0.152008, 0.0783269, -0.0845013, -0.161045, 0.0366117, 0.174963], [0.114271, 0.148715, -0.171792, 0.0538962, 0.171969, 0.0206536, -0.00160193, 0.166969, -0.129949, -0.0890283, 0.103756, -0.107145, -0.0794701, 0.102927, -0.0131012, -0.14378, 0.0812338, 0.076243, -0.100813, 0.00660641, 0.0957293, -0.0112779, 0.00240681, 0.0838015, -0.0446694, -0.0548368, 0.0334084, 0.0194797, -0.0315756, 0.0191348, 0.0274677, -0.0525468], [-0.00943001, -0.015422, 0.0254482, 0.0424606, 0.0562977, -0.0265945, -0.061034, 0.031239, -0.0279008, -0.0856526, -0.0841043, -0.0302999, -0.0239715, 0.0799268, 0.0928408, 0.0387994, 0.0535097, -0.105397, 0.0522943, 0.128188, -0.146365, 0.0407088, 0.137629, -0.0672568, -0.0740973, 0.134707, -0.132997, -0.0966229, 0.169892, 0.0427086, -0.000536832, -0.194385], [0.114914, -0.124483, -0.143573, 0.105523, -0.151815, -0.0669367, 0.151947, -0.0318579, 0.097868, 0.12405, -0.00910709, 0.15865, -0.0484067, -0.14567, 0.111302, 0.0383761, 0.0420287, -0.107397, -0.103207, 0.0216347, -0.0489872, 0.0834208, -0.0646712, -0.0465682, -0.00190678, -0.0553291, 0.0300707, 0.0627579, 0.0560326, -0.0176998, -0.0195444, 0.013878], [-0.0614953, 0.00420633, 0.00356218, -0.053479, 0.0035589, 0.0118066, 0.0128621, 0.0749181, 0.0706297, 0.020587, 0.0798107, -0.0462118, -0.0630821, 0.0981865, -0.0741026, -0.0921679, -0.00908556, -0.143312, -0.144377, -0.0442184, 0.09539, 0.107645, -0.139815, 0.0609318, 0.0780867, -0.131747, 0.159502, 0.0380687, 0.00702285, 0.16738, 0.16537, -0.0670956], [-0.14091, 0.0957528, -0.0380862, -0.162691, 0.139095, 0.0712966, -0.150896, -0.00627521, -0.113076, -0.0941128, 0.0745822, -0.133895, 0.141606, -0.0430907, -0.0549016, 0.128901, 0.0498608, 0.14343, -0.00419273, -0.0818288, 0.0562051, -0.0415407, -0.0539985, -0.0357061, -0.0700929, 0.0331913, 0.000683185, 0.071303, 0.06816, 0.0344802, 0.00198161, 0.00342018], [0.0080642, -0.00881911, 0.0643162, 0.0317426, -0.00572449, 0.0539478, -0.0515907, -0.047078, 0.0192707, -0.0738166, -0.0757689, 0.0170943, 0.0932313, -0.0487987, -0.0668711, 0.090768, 0.0246866, 0.133457, -0.0488735, -0.137996, -0.139489, -0.0643836, 0.110938, 0.104975, 0.157101, 0.00567878, 0.074384, -0.143899, -0.160429, 0.0530126, -0.0778456, 0.174009], [0.157911, -0.0365234, -0.0491434, 0.147217, -0.0166281, -0.154654, -0.151295, -0.0239369, -0.124226, 0.0814128, 0.133967, 0.0675956, 0.0887769, -0.123059, 0.0505264, 0.133292, -0.0903061, -0.0957946, -0.0756775, 0.0163823, 0.0530324, 0.0457439, 0.0129201, -0.0735388, 0.0737254, -0.02787, -0.0444515, -0.0376297, -0.0223196, 0.0653717, 0.00546947, 0.000553147], [0.0469649, -0.012096, -0.0135137, 0.0130645, -0.0297515, -0.0500502, 0.0261904, 0.0699777, -0.0869157, -0.00255574, -0.050604, 0.0674431, 0.0162137, -0.105386, 0.104022, 0.0644615, 0.10032, -0.0592746, -0.0749468, -0.128814, -0.0496251, 0.145602, -0.143943, 0.0716282, -0.154179, -0.0535392, 0.163115, 0.00247193, 0.0619495, 0.153414, 0.0904303, -0.150981], [0.108248, -0.136698, 0.0897609, 0.141077, -0.160354, -0.0485686, -0.0135441, -0.160343, 0.144563, 0.039715, -0.0220531, 0.1447, -0.121272, 0.0827364, 0.11723, -0.0390911, -0.0718585, -0.0940438, 0.0457431, -0.0824471, -0.0823213, -0.00669244, 0.0494861, 0.0665874, -0.0319311, 0.0641938, -0.00756205, -0.0516873, -0.0163203, 0.007295, 0.049131, -0.000661787], [0.0397674, -0.0162878, 0.0396906, 0.0519331, -0.0254641, -0.0100547, -0.0301215, 0.0533692, -0.0196369, -0.0776385, -0.0909215, -0.0244526, 0.0566459, -0.0764326, 0.116875, 0.0217675, -0.107048, 0.0855889, -0.0127148, 0.146114, 0.0969067, 0.118738, -0.10721, -0.11985, 0.141016, -0.0568864, -0.00819989, -0.160174, -0.178203, -0.000498675, 0.0894397, -0.148055], [0.0215076, -0.185143, 0.0217379, 0.165988, -0.135638, -0.0965188, -0.163319, 0.0254992, 0.152006, -0.0268135, 0.120557, 0.0915262, -0.0856437, 0.121404, 0.0743867, -0.106903, -0.0350185, -0.112875, 0.0676085, -0.0323355, -0.0789251, 0.0335989, -0.0677695, -0.0390652, 0.00556601, 0.084054, 0.0609872, 0.0321413, 0.00473044, -0.0428768, -0.0134091, 0.0198901], [-0.0571063, 0.0295394, 0.0201595, 0.0248451, -0.0078372, -0.032944, 0.0609646, -0.0283533, 0.0186628, 0.0833359, -0.0628096, -0.051437, 0.0221108, -0.0976674, 0.109338, 0.0639545, -0.0490821, 0.129616, -0.141732, -0.0322512, 0.139436, -0.0147198, -0.0747447, -0.132565, -0.133892, 0.075193, 0.121398, -0.107256, 0.0655694, 0.158557, 0.0315766, -0.182837], [0.160524, -0.0779731, -0.166308, -0.0306438, -0.0647868, 0.152024, 0.00980735, -0.160773, -0.0789021, -0.120541, 0.13434, 0.0646556, 0.0473086, 0.132176, 0.0683181, -0.102737, -0.0892204, 0.0744531, -0.0957579, 0.0132037, 0.0912162, -0.0242316, -0.0636402, -0.0465174, -0.00495318, 0.070223, 0.0522084, 0.0283466, 0.00938225, -0.0562312, -0.0172542, 0.0062665], [0.00546001, 0.0274047, 0.0337031, -0.0464176, -0.0324337, -0.0268272, 0.0744643, 0.013069, -0.0570508, 0.0538376, 0.0294204, 0.0885624, -0.0936053, -0.0236729, -0.0214052, -0.109794, 0.13812, -0.0505678, 0.0673594, -0.132958, 0.138669, 0.0685078, -0.0607687, 0.139508, -0.144419, 0.0619195, -0.0987236, -0.132184, 0.0572919, 0.164697, -0.170971, -0.0484548], [0.0104372, 0.17703, -0.127753, -0.11908, 0.110924, 0.11594, 0.154519, -0.0503865, -0.156856, 0.0250321, -0.0132039, -0.143789, -0.0903498, 0.108407, 0.121222, 0.0260416, 0.0754312, -0.109318, -0.00370512, 0.0976613, -0.0891746, -0.0518934, 0.0493776, 0.0503809, -0.0673675, 0.0149361, -0.0111516, 0.025944, 0.0519307, -0.0238818, -0.0111922, -0.0538077], [0.00279536, 0.00168191, -0.00545978, -0.0706899, 0.0662493, -0.0298853, -0.0671429, -0.030472, -0.0594592, 0.0380366, 0.056765, 0.0486148, -0.00544465, 0.0798984, 0.0692513, -0.122008, -0.148362, 0.0184237, -0.111761, -0.0980652, -0.0943168, 0.119902, 0.1387, 0.0253167, -0.0229595, -0.156595, 0.0101381, 0.160232, 0.105073, 0.119385, 0.149257, -0.0712211], [0.0494021, -0.168744, -0.0847088, -0.141471, -0.154961, -0.0547475, 0.151209, -0.0677486, -0.0976521, 0.129119, 0.0706529, 0.138558, 0.140327, 0.0525016, -0.128306, 0.0341419, -0.0128025, -0.0978576, -0.014508, 0.107068, 0.0586907, -0.0776423, 0.0782904, -0.010045, -0.0680175, -0.0423396, 0.0375441, 0.0468705, -0.043993, 0.0324808, 0.00296569, -0.0221015], [-0.0246021, -0.0228231, 0.00803273, 0.0528477, 0.0589817, 0.0159657, 0.05179, -0.04291, -0.0587096, 0.036636, 0.00886632, -0.0926605, -0.0679267, -0.0833739, -0.118089, -0.00509598, 0.105833, 0.0858742, -0.0515782, 0.121214, 0.146631, -0.0136472, 0.0333706, 0.146425, 0.0975227, -0.120915, -0.141869, 0.0883776, -0.033221, -0.172201, -0.155649, -0.0863426], [0.100674, -0.147152, -0.163445, 0.0281296, -0.0870778, 0.143, 0.101042, 0.125529, -0.0524251, -0.15551, 0.146778, 0.031102, 0.00848988, 0.13033, -0.118641, -0.0628667, 0.108866, -0.0456823, -0.0829426, 0.0533302, 0.0321053, -0.0974701, -0.034348, -0.0687749, 0.0571835, 0.0422309, -0.0108831, 0.05242, -0.0466012, -0.0059457, 0.0274465, -0.0211703], [-0.0181102, -0.0107175, 0.0032184, 0.0649768, 0.0252672, -0.0664401, 0.0418776, 0.00239251, -0.0784023, -0.0123634, -0.0708594, 0.0621621, -0.059065, -0.0967734, 0.0856058, 0.0477931, 0.109401, -0.0398901, 0.0718896, 0.132055, -0.0451958, 0.148651, 0.00457654, -0.152965, -0.145274, -0.0691363, -0.157579, 0.051782, 0.104276, -0.124589, 0.172929, 0.0335571], [0.0215769, -0.180895, 0.129778, -0.117694, -0.164587, 0.0122557, -0.0152836, 0.158766, 0.10206, 0.121697, 0.153271, -0.00343977, -0.107555, -0.106101, -0.00691223, -0.111915, 0.0834518, 0.0404731, -0.0870403, 0.0870386, 0.0667976, -0.0684657, -0.0819634, -0.00967344, 0.010918, 0.074474, -0.0211639, -0.0508676, 0.0431849, -0.00957107, -0.0201852, 0.0179541], [-0.0132052, 0.0303689, -0.0499545, -0.0326573, 0.0221098, -0.0185207, 0.0627147, 0.0345015, -0.0474558, 0.0726951, -0.0142376, -0.0944998, -0.122136, -0.00126482, 0.0563942, -0.0711778, 0.0551129, 0.107065, 0.11855, -0.0217047, -0.107672, -0.111253, -0.0174381, 0.156086, -0.128167, 0.0971619, 0.153457, 0.066471, 0.0213853, -0.168753, 0.136421, -0.111098], [0.164825, -0.064124, -0.0347186, -0.172916, -0.0643779, 0.146481, -0.143585, -0.0727701, 0.133109, 0.071656, -0.143499, 0.0595503, 0.0792631, -0.108293, 0.00391671, -0.100312, 0.0425553, 0.12854, 0.0981565, -0.00969821, -0.0548606, -0.0682273, -0.0838125, 0.00280497, -0.0340489, 0.0677578, 0.0299498, -0.0370749, -0.0170726, 0.000199579, 0.0419997, 0.0407686], [-0.00134676, -0.0276032, -0.00166525, 0.0486993, 0.0660432, -0.0183282, -0.0595791, 0.0267636, 0.0618886, 0.0555111, -0.0367823, -0.085934, -0.0903279, -0.0330837, 0.056321, -0.101331, -0.0831959, 0.113752, 0.00557184, 0.138622, 0.146189, 0.0317376, -0.156155, 0.0321869, 0.143866, -0.0728021, -0.135201, -0.107476, -0.00967166, -0.166465, 0.105015, 0.13312], [-0.186104, -0.040683, 0.00788311, -0.183089, 0.146644, -0.105039, 0.155072, 0.0256174, 0.00530324, 0.148654, -0.124555, 0.033017, -0.057311, -0.115661, 0.0428764, -0.104158, -0.080992, 0.101432, -0.0998926, -0.0576144, 0.0853636, 0.0942883, 0.0867264, -0.0389815, -0.00120942, -0.0469936, -0.0485181, 0.000327594, 0.0466835, 0.0125306, -0.00430321, 0.0552411], [0.0204619, 0.0126948, -0.0442013, 0.00525801, -0.0267261, 0.0778607, -0.0153789, -0.066441, 0.0478051, -0.0449542, 0.0582818, 0.0647393, -0.0863319, -0.0558226, 0.114892, -0.0192959, -0.121749, 0.0370549, 0.0426862, -0.131196, 0.0371058, 0.154394, -0.0588241, -0.151005, 0.148002, 0.0675538, -0.0968586, 0.135232, 0.138506, -0.108297, -0.169893, -0.0588472], [-0.132376, -0.112351, 0.127142, 0.10309, -0.145595, 0.0682041, 0.0131547, -0.162384, 0.123554, -0.102132, -0.0631335, 0.137585, 0.0340206, 0.137472, -0.119082, -0.0190984, 0.13312, -0.00391188, -0.04095, -0.0949139, -0.0612187, 0.0381545, 0.0631191, 0.0398695, -0.0053229, 0.0671293, -0.0389295, -0.0292275, 0.0449721, -0.064387, 0.0166426, -0.00372258], [0.00732669, 0.0421278, -0.00292136, -0.0245678, 0.0693214, 0.00738691, -0.0671594, -0.00573522, 0.0475982, -0.0655278, -0.036805, -0.0854698, -0.0585601, 0.068488, 0.0825587, 0.100717, 0.00890851, 0.132132, -0.132188, -0.0661438, 0.136594, -0.0595817, -0.149162, 0.0385082, 0.0546159, -0.14581, 0.15218, 0.0443829, -0.0664176, -0.162977, -0.0897798, 0.151549], [0.0378004, -0.17217, -0.166181, -0.0223737, -0.136363, 0.0972205, 0.139181, -0.0890092, -0.050308, 0.141188, 0.140845, 0.00518318, 0.038733, 0.135712, 0.106986, 0.0812906, -0.099617, -0.0871335, -0.0263982, -0.10937, -0.0890563, 0.0179274, 0.0483189, -0.0768574, -0.0330562, 0.0585027, 0.054927, -0.0116675, 0.0281689, 0.0445841, -0.0247614, -0.0245503], [0.00171647, 0.0323212, -0.0473585, -0.0363496, 0.0227253, -0.0275777, 0.0706225, 0.0231216, -0.0770846, 0.0202135, -0.0318887, 0.0855976, -0.00432396, -0.0891107, 0.0790179, -0.0639152, 0.0706731, 0.11257, -0.140751, -0.0486211, -0.0761452, -0.132475, -0.134815, 0.0817942, 0.151162, 0.0349361, 0.0446329, -0.160447, -0.0256903, 0.168718, 0.156511, -0.0847088], [0.112627, 0.15162, -0.0548816, 0.170187, 0.0743218, -0.138613, 0.0284676, 0.128024, 0.142153, -0.0243935, -0.137818, 0.060562, 0.121965, 0.0579575, -0.0421047, -0.1401, -0.125537, -0.0646629, -0.044358, 0.082346, 0.0644906, -0.0607104, 0.0418625, 0.0613568, -0.0733421, 0.00071949, 0.0450745, -0.00202968, -0.0137764, 0.020537, -0.016089, -0.0578304], [0.0217812, -0.0551193, -0.0231841, 0.015687, -0.0481596, -0.0421769, 0.03349, 0.0318812, -0.0130639, 0.0893468, 0.0763214, -0.0138062, -0.0858654, 0.0359956, 0.0908857, 0.0910596, -0.0300353, -0.13553, -0.112173, -0.0885569, 0.06077, -0.133034, 0.134186, -0.0755138, -0.100141, 0.130697, -0.160715, 0.00292123, 0.155748, 0.0269821, 0.0287711, 0.167357], [0.148206, -0.0751393, -0.0428279, -0.163697, -0.165128, -0.0214927, 0.147579, 0.0498905, -0.0393489, 0.152361, 0.0660614, 0.136699, -0.119733, 0.0872042, 0.0616545, -0.121605, -0.0892296, -0.077497, 0.0863544, -0.0262177, -0.0810899, 0.0122624, -0.00746188, -0.0829069, 0.0550208, 0.0479124, 0.0274955, -0.0205916, -0.0269277, -0.0137244, -0.0165629, 0.0635035], [0.0134376, 0.0255346, -0.0480798, -0.0188533, 0.0193754, -0.0494378, 0.0783086, -0.0189105, -0.0631774, 0.0452593, 0.0776095, 0.067396, -0.00890254, 0.10125, -0.0396479, -0.0886872, 0.0434454, -0.133304, -0.12607, -0.0675718, -0.147734, 0.0268076, 0.128126, -0.093671, -0.0972329, 0.134244, 0.160014, 0.0234264, 0.0618332, 0.162325, -0.0592645, -0.169783], [0.177392, -0.0073142, 0.0675111, 0.163515, 0.0328769, -0.167503, -0.101089, -0.133062, -0.158508, -0.0197647, -0.0481339, 0.126373, 0.0967994, -0.0921636, -0.11068, 0.0636759, 0.10692, 0.0680072, -0.0131136, -0.0982414, 0.0212618, 0.0879821, 0.0833489, -0.0106499, -0.0692862, -0.0425489, 0.0234209, 0.0257781, 0.0168542, -0.0402364, -0.0399788, 0.0214335], [-0.0138571, 0.0252476, 0.00339085, -0.0410708, 0.0600799, 0.00114268, -0.0665146, -0.0192615, 0.0500384, 0.0695552, -0.0310391, 0.0919046, 0.0329531, -0.0983678, -0.110766, 0.045774, -0.0719911, -0.0951091, 0.121955, -0.0422118, 0.144744, 0.0584145, -0.161627, -0.0411915, 0.044746, 0.157658, -0.0258661, -0.174366, -0.104159, 0.143673, 0.117492, -0.133961], [-0.190159, 0.0559258, -0.149603, -0.0872806, 0.0869376, 0.143346, 0.16059, 0.0279523, 0.102561, -0.12938, -0.121056, 0.0397007, -0.0366034, -0.148135, -0.0435338, 0.1422, 0.0985262, -0.0320213, -0.0629934, 0.046317, 0.0642949, 0.0665127, -0.0803638, -0.0515672, -0.00370917, 0.0594211, 0.0181992, -0.07886, 0.0348053, -0.00133125, -0.0279357, -0.0182685], [0.0491851, 0.0439095, -0.0246317, 0.0574119, 0.0199289, -0.0138036, -0.0392483, -0.0108163, 0.0581988, -0.061469, -0.0241117, -0.0816331, 0.134736, -0.00473131, -0.0982935, 0.0448992, -0.0950805, -0.0399244, 0.00383138, 0.138693, 0.112191, 0.103536, 0.00943541, -0.158483, -0.110021, 0.127783, -0.107597, -0.131182, 0.118211, -0.118077, -0.177657, -0.0146965], [-0.163913, 0.0282791, -0.109253, 0.128116, 0.0339183, 0.165357, 0.02404, -0.151262, 0.127276, 0.0838926, -0.129004, -0.055638, 0.146888, -0.0121914, -0.0629686, -0.119067, 0.0985585, -0.0910299, -0.0310152, 0.101188, 0.0430697, 0.0756536, -0.0800062, 0.036129, -0.0493618, -0.0298486, 0.0606143, 0.00137766, 0.0139581, -0.0561764, -0.00722554, 0.0266538]])

print("p_center shape:", p_center.shape)

vector1 = vector1 - c_center
vector2 = vector2 - c_center

index1 = np.array([])
index2 = np.array([])
for i in  range(p_center.shape[0]):
	arr1 = np.array([])
	arr2 = np.array([])
	for j in range(p_center.shape[1] // 2):
		arr1 = np.append(arr1, sum(vector1[2*i:2*i+2]*p_center[i][2*j:2*j+2]))
		arr2 = np.append(arr2, sum(vector2[2*i:2*i+2]*p_center[i][2*j:2*j+2]))
	#print("arr1, arr2 size :", arr1.shape, arr2.shape)
	index1 = np.append(index1, np.argmin(arr1))
	index2 = np.append(index2, np.argmin(arr2))
print("index1")
print(index1)
print("index2")
print(index2)

searcher_path = "/arc-share/MICRO21_ANNA/scann_searcher/glove/Split_1/glove_searcher_1_0"

#searcher = scann.scann_ops_pybind.builder(normalized_dataset, 10, "dot_product").tree(
#    num_leaves=2000, num_leaves_to_search=100, training_sample_size=250000).score_ah(
#    2, anisotropic_quantization_threshold=0.2).reorder(10).build()

#os.makedirs(searcher_path, exist_ok=True)
#searcher.serialize(searcher_path)

searcher = scann.scann_ops_pybind.load_searcher(searcher_path)

def compute_recall(neighbors, true_neighbors):
    total = 0
    for gt_row, row in zip(true_neighbors, neighbors):
        total += np.intersect1d(gt_row, row).shape[0]
    return total / true_neighbors.size

neighbors, distances = searcher.search(queries[0])
